#coding:utf-8
import numpy
import MySQLdb
from bokeh.charts import Donut, output_file, show, Bar
import bokeh.plotting as bk


connection = MySQLdb.connect(host = 'localhost',user = 'root',passwd = 'root',db = 'test1',charset = 'utf8')
cursor = connection.cursor()
query = "select * from kaifulee"
cursor.execute(query)
cursor.fetchall()

data = []
time = []

i = 0
for item in cursor:
    data.append(item[3])
    time.append(item[1])
    i += 1
    if (i)>20:
        break

bar_data = {
    'senti':data ,
    'time':time
}

aapl = numpy.array(data)
aapl_dates = numpy.array(time)

window_size = 30
window = numpy.ones(window_size)/float(window_size)
# output to static HTML file

output_file("stocks.html", title="stocks.py example")

'''
p = bk.figure(width=800, height=350, x_axis_type="datetime")
p.circle(aapl_dates, aapl, size=3, color='darkgrey', alpha=0.2, legend='sentiment')
p.title = "Weibo Sentiment Analysis"
p.legend.orientation = "top_left"
p.grid.grid_line_alpha=0
p.xaxis.axis_label = 'Date'
p.yaxis.axis_label = 'Scale'
p.ygrid.band_fill_color="olive"
p.ygrid.band_fill_alpha = 0.1
show(p)
'''

p = bk.figure(width=800, height=350, x_axis_type="datetime")
bar = Bar(data,'time', title="Python Interpreter Sampling", plot_width=400,agg = 'mean')
show(bar)